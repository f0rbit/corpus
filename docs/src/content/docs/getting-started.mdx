---
title: Getting Started
description: Install Corpus and store your first versioned snapshot in under 5 minutes.
---

import { Aside } from '@astrojs/starlight/components';

Get up and running with Corpus in minutes. You'll define a schema, create a corpus, and store your first versioned snapshot.

<div class="stepper stepper-vertical">
  <div class="step vertical-connector-item">
    <div class="step-indicator vertical-indicator">1</div>
    <div class="step-content vertical-content">
      <div class="step-title">Install the package</div>
      <div class="step-body">
        ```bash
        bun add @f0rbit/corpus zod
        ```
      </div>
    </div>
    <div class="step-connector vertical-connector" />
  </div>

  <div class="step vertical-connector-item">
    <div class="step-indicator vertical-indicator">2</div>
    <div class="step-content vertical-content">
      <div class="step-title">Define a schema</div>
      <div class="step-body">
        Corpus uses [Zod](https://zod.dev) for type-safe serialization. Define a schema for your data:

        ```typescript
        import { z } from 'zod'

        const PostSchema = z.object({
          title: z.string(),
          body: z.string(),
          published: z.boolean(),
          tags: z.array(z.string()).optional(),
        })

        type Post = z.infer<typeof PostSchema>
        ```

        <Aside type="tip">
          Zod schemas serve as the single source of truth - they define both validation rules and TypeScript types.
        </Aside>
      </div>
    </div>
    <div class="step-connector vertical-connector" />
  </div>

  <div class="step vertical-connector-item">
    <div class="step-indicator vertical-indicator">3</div>
    <div class="step-content vertical-content">
      <div class="step-title">Create a corpus</div>
      <div class="step-body">
        Use the builder pattern to configure your corpus with a backend and stores:

        ```typescript
        import { 
          create_corpus, 
          create_memory_backend, 
          define_store, 
          json_codec 
        } from '@f0rbit/corpus'

        const corpus = create_corpus()
          .with_backend(create_memory_backend())
          .with_store(define_store('posts', json_codec(PostSchema)))
          .build()
        ```
      </div>
    </div>
    <div class="step-connector vertical-connector" />
  </div>

  <div class="step vertical-connector-item">
    <div class="step-indicator vertical-indicator">4</div>
    <div class="step-content vertical-content">
      <div class="step-title">Store and retrieve data</div>
      <div class="step-body">
        Use the typed store to save and load snapshots:

        ```typescript
        const post: Post = {
          title: 'Hello World',
          body: 'My first post using Corpus.',
          published: true,
        }

        const result = await corpus.stores.posts.put(post)

        if (result.ok) {
          const { version, content_hash } = result.value
          console.log(`Saved version ${version} with hash ${content_hash}`)
        }
        ```
      </div>
    </div>
    <div class="step-connector vertical-connector" />
  </div>

  <div class="step vertical-connector-item">
    <div class="step-indicator vertical-indicator">5</div>
    <div class="step-content vertical-content">
      <div class="step-title">Handle errors with pattern matching</div>
      <div class="step-body">
        Corpus uses `Result<T, E>` types instead of throwing exceptions:

        ```typescript
        const snapshot = await corpus.stores.posts.get('nonexistent-version')

        if (!snapshot.ok) {
          switch (snapshot.error.kind) {
            case 'not_found':
              console.log(`Version ${snapshot.error.version} does not exist`)
              break
            case 'decode_error':
              console.log('Data corruption detected:', snapshot.error.cause)
              break
            case 'storage_error':
              console.log('Backend failed:', snapshot.error.operation)
              break
          }
          return
        }

        console.log('Post title:', snapshot.value.data.title)
        ```
      </div>
    </div>
  </div>
</div>

## Package Exports

Corpus provides multiple entry points to minimize bundle size and keep platform-specific code separate.

### Full Package

```typescript
import { create_corpus, define_store, json_codec, ok, err } from '@f0rbit/corpus'
```

The main entry point includes all core utilities, the memory backend, Result types, and pipe utilities. Use this for most applications.

### File Backend (Node.js)

```typescript
import { create_file_backend } from '@f0rbit/corpus/file'
```

File system backend for Node.js and Bun environments. Stores snapshots as JSON files on disk.

### Cloudflare Backend (Workers)

```typescript
import { create_cloudflare_backend } from '@f0rbit/corpus/cloudflare'
```

Cloudflare Workers backend using D1 for metadata and R2 for blob storage. Import only in Worker environments.

### Types Only

```typescript
import type { Result, Snapshot, CorpusError } from '@f0rbit/corpus/types'
```

TypeScript type definitions with no runtime code. Use for type annotations in shared interfaces or when you only need types for dependency injection.

### Drizzle Schemas

```typescript
import { snapshots, observations, lineage } from '@f0rbit/corpus/schema'
```

Drizzle ORM table definitions for the Corpus data model. Use when you need to query Corpus tables directly or integrate with existing Drizzle schemas.

<Aside type="tip">
  Tree-shaking works best when you import from specific entry points. For Cloudflare Workers, always use `@f0rbit/corpus/cloudflare` to avoid bundling Node.js-specific code.
</Aside>

## Next Steps

<div class="grid">
  <a href="/corpus/guides/backends/" class="card card-interactive">
    <div class="card-title">Storage Backends</div>
    <div class="card-description">Learn about memory, file, and Cloudflare backends</div>
  </a>
  <a href="/corpus/guides/cloudflare/" class="card card-interactive">
    <div class="card-title">Cloudflare Deployment</div>
    <div class="card-description">Deploy to Cloudflare Workers with D1 and R2</div>
  </a>
  <a href="/corpus/guides/observations/" class="card card-interactive">
    <div class="card-title">Observations</div>
    <div class="card-description">Extract structured facts with provenance tracking</div>
  </a>
  <a href="/corpus/guides/testing/" class="card card-interactive">
    <div class="card-title">Testing Patterns</div>
    <div class="card-description">Write tests using the memory backend</div>
  </a>
</div>
